Pinyin4net.dll
how to run a dns server

[DllImport("advapi32.dll")]
public static extern bool LogonUser(string userName, string domainName, string password, int LogonType, int LogonProvider, ref IntPtr phToken);
IntPtr tokenHandler = IntPtr.Zero;
var domain = default(string);
var authorized = LogonUser("tony@company.com", domain, "password", 2, 0, ref tokenHandler);

#include <sys/types.h>
#include <pwd.h>
#include <shadow.h>

#define _GNU_SOURCE
#include <crypt.h>

extern int auth_sys_user (const char*username, const char*password) 
{
    struct passwd *pw;
    struct spwd *sp;
    char *encrypted, *correct;

    pw = getpwnam(username);
    endpwent();

    if (!pw) return 1; //user doesn't really exist

    sp = getspnam(pw->pw_name);
    endspent();

    correct = sp ? sp->sp_pwdp : pw->pw_passwd;
    encrypted = crypt(password, correct);
    return strcmp(encrypted, correct) ? 2 : 0;  // bad pw=2, success=0
}

/usr/share/xsessions